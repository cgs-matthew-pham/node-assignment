<!DOCTYPE html>
<html>
	<head>
		<title>Fetch examples</title>
		<script src="//ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
		<script>

			var url = 'http://localhost:3000/tasks';
      var msg;

      function init() {
        msg = document.getElementById("msg");
      }

			async function listAllTasks() {
				let response = await fetch(url);
				let data = await response.json();
				msg.innerHTML = JSON.stringify(data);
			}

			async function createTask() {
				let desc = prompt("Enter a task description: ");
				let response = await fetch(url, {
					headers: {
						"Content-Type": "application/json; charset=utf-8"
					},
						method: 'POST',
						body: JSON.stringify({
							name: desc,
						})
					});
					let data = await response.json();
				msg.innerHTML = JSON.stringify(data);
			}

			async function readTask() {
        let id = prompt("Enter a task ID: ");
        let response = await fetch(url + "/" + id);
          let data = await response.json();
        msg.innerHTML = JSON.stringify(data);
			}

			async function updateTask() {
        let id = prompt("Enter a task ID: ");
        let newStatus = prompt("Enter a status (pending, ongoing or completed)");
        let response = await fetch(url + "/" + id, {
          headers: {
            "Content-Type": "application/json; charset=utf-8"
          },
            method: 'PUT',
            body: JSON.stringify({
              status: newStatus,
            })
          });
          let data = await response.json();
        msg.innerHTML = JSON.stringify(data);
      }

			async function deleteTask() {
        let id = prompt("Enter a task ID: ");
        let response = await fetch(url + "/" + id, {
          headers: {
            "Content-Type": "application/json; charset=utf-8"
          },
            method: 'DELETE'
          });
          let data = await response.json();
        msg.innerHTML = JSON.stringify(data);
      }
			

		</script>
	</head>
	<body onload="init()">
		<h1>To Do List</h1>
		<button onclick='listAllTasks()'>
			List all tasks
		</button>
		<button onclick='createTask()'>
			Create task
		</button>
		<button onclick='readTask()'>
			Read task
		</button>
		<button onclick='updateTask()'>
			Update task
		</button>
		<button onclick='deleteTask()'>
			Delete task
		</button>
    <p id="msg"></p>
	</body>
</html>
